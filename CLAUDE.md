# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Development Commands

```bash
pnpm install              # Install dependencies (uses pnpm)
pnpm dev                  # Start Vite dev server on port 3000
pnpm build                # Production build
pnpm test                 # Run Vitest tests
pnpm check                # Run Biome linter + formatter check
pnpm convex:dev           # Start Convex backend dev server (npx convex dev)
pnpx shadcn@latest add <component>  # Add new Shadcn UI component
```

Both `pnpm dev` and `pnpm convex:dev` must be running during development.

## Architecture

**Exercise Journal** is a workout tracking app built as a React 19 SPA with a Convex serverless backend, deployed to Netlify.

### Tech Stack
- **Frontend:** React 19, TypeScript, Vite 6
- **Routing:** TanStack Router (file-based, routes in `src/routes/`)
- **Backend/DB:** Convex — schema, queries, and mutations live in `convex/`
- **UI:** Shadcn (New York style) + Radix UI + Tailwind CSS 4 (OKLCH colors)
- **Forms:** TanStack React Form with Zod validation
- **Linting/Formatting:** Biome (tabs, double quotes, organized imports)
- **Testing:** Vitest + React Testing Library

### Data Flow
- Convex functions (`convex/*.ts`) define `query` and `mutation` exports
- Frontend uses `useQuery`/`useMutation` from `convex/react` for real-time data
- API types are auto-generated in `convex/_generated/` — never edit those files
- `src/routeTree.gen.ts` is auto-generated by TanStack Router — never edit

### Key Domain Concepts
- **Exercises** belong to **ExerciseGroups** (muscle groups) and optionally link to a **Barbell**
- **Workouts** have a `startTime` and optional `endTime` — a missing `endTime` means the workout is active
- **Sets** connect an exercise to a workout with count/weight/unit (kg or lbs)
- Max 20 sets per exercise; oldest sets are auto-deleted when the limit is reached
- **Templates** store preset exercise lists for quick workout creation

### Project Layout
- `convex/` — Backend: schema (`schema.ts`), domain functions (exercises, workouts, sets, etc.)
- `src/routes/` — File-based pages (index, exercises.$exerciseId, workouts, templates)
- `src/components/ui/` — Shadcn UI primitives
- `src/components/` — Feature components organized by domain (exercise/, exercises/, workouts/)
- `src/hooks/` — Custom hooks (form context, debounce, mobile detection, workout timer)
- `src/integrations/` — Provider setup (Convex, toast)

### Convex Conventions
- Every document has auto-generated `_id` and `_creationTime` system fields — don't redefine them
- Use `v` from `convex/values` for schema validators (not Zod — Zod is for frontend form validation only)
- Reference other tables with `v.id("tableName")`
- Queries/mutations are exported as named functions using `query()`/`mutation()` from `convex/_generated/server`

### Code Style
- Biome handles formatting: tabs for indentation, double quotes, auto-import organization
- Path alias: `@/*` maps to `src/*`
- Icons: Lucide React (import from `lucide-react`)
- App is always in dark mode (`<html className="dark">`)
